

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Basis Algorithms &mdash; exatomic 0.3.11 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Orbital Algorithms" href="orbital.html" />
    <link rel="prev" title="Matrices" href="../matrices.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> exatomic
          

          
            
            <img src="../../_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.3.11
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html#anaconda">Anaconda</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html#pypi">Pypi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html#repository">Repository</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html#what-s-next">What’s Next?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../install.html#note">Note</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../started.html">Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">General</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">User Docs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#supported-software">Supported Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#version-information">Version Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="../universe.html">Universe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../editor.html">Editors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../widgets.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interfaces.html">External Interfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../atom.html">Description of Nuclear Coordinates</a></li>
<li class="toctree-l2"><a class="reference internal" href="../two.html">Atom Two</a></li>
<li class="toctree-l2"><a class="reference internal" href="../orbital.html">Orbitals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basis.html">Description of Basis Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tensor.html">Tensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../frame.html">Frame</a></li>
<li class="toctree-l2"><a class="reference internal" href="../molecule.html">Molecules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../field.html">Scalar Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="../matrices.html">Matrices</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Basis Algorithms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#basis-function-manipulation">Basis Function Manipulation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spherical-and-solid-harmonics">Spherical and Solid Harmonics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numerical-methods-and-classes">Numerical methods and classes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="orbital.html">Orbital Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="integrals.html">Common Orbital Integrals</a></li>
<li class="toctree-l2"><a class="reference internal" href="structural.html">Structural Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="builders.html">Molecular and System Builders</a></li>
<li class="toctree-l2"><a class="reference internal" href="delocalization.html">Exchange-Correlation Delocalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="interpolation.html">Interpolation Helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="neighbors.html">Clustering Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../error.html">Core Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="indexing.html">Indexing Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tests/base_tests.html">Base Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tests/core_tests.html">Core Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tests/algorithms_tests.html">Algorithms Tests</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/water-demo.html">Import</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/water-demo.html#Parse-Test-Data">Parse Test Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/water-demo.html#Construct-a-Periodic-Universe-(by-hand)">Construct a Periodic Universe (by hand)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/water-demo.html#Compute-Distances-Between-Atoms">Compute Distances Between Atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/water-demo.html#Visualize-Trajectory-(press-play-multiple-times-to-speed-up-framerate)">Visualize Trajectory (press play multiple times to speed up framerate)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/nwchem.html">NWChem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../notebooks/qe.html">Support for Quantum ESPRESSO in exatomic</a></li>
</ul>
<p class="caption"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../software/adf.html">ADF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/gaussian.html">Gaussian</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/molcas.html">Molcas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/nbo.html">NBO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/nwchem.html">NWChem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software/qe.html">Quantum ESPRESSO</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributors</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contrib.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../concepts.html">Development</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">exatomic</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">User Docs</a> &raquo;</li>
        
      <li>Basis Algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/api/algorithms/basis.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="module-exatomic.algorithms.basis">
<span id="basis-algorithms"></span><h1>Basis Algorithms<a class="headerlink" href="#module-exatomic.algorithms.basis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basis-function-manipulation">
<h2>Basis Function Manipulation<a class="headerlink" href="#basis-function-manipulation" title="Permalink to this headline">¶</a></h2>
<p>Functions for managing and manipulating basis set data.
Many of the ordering schemes used in computational codes can be
generated programmatically with the right numerical function.
This is preferred to an explicit parsing and storage of a given
basis set ordering scheme.</p>
<dl class="function">
<dt id="exatomic.algorithms.basis.gen_enum_cartesian">
<code class="descclassname">exatomic.algorithms.basis.</code><code class="descname">gen_enum_cartesian</code><span class="sig-paren">(</span><em>lmax</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#gen_enum_cartesian"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.gen_enum_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian powers in the order expected for overlap
computation up to order lmax.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – highest order angular momentum quantum number</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="exatomic.algorithms.basis.spherical_harmonics">
<code class="descclassname">exatomic.algorithms.basis.</code><code class="descname">spherical_harmonics</code><span class="sig-paren">(</span><em>lmax</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#spherical_harmonics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.spherical_harmonics" title="Permalink to this definition">¶</a></dt>
<dd><p>Symbolic real spherical harmonics up to order lmax.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="o">=</span> <span class="n">spherical_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># Inclusive, so computes up to l = 6</span>
<span class="n">sh</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>                    <span class="c1"># symbolic f-phi angular function</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – highest order angular momentum quantum number</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="exatomic.algorithms.basis.solid_harmonics">
<code class="descclassname">exatomic.algorithms.basis.</code><code class="descname">solid_harmonics</code><span class="sig-paren">(</span><em>lmax</em>, <em>scaled=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#solid_harmonics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.solid_harmonics" title="Permalink to this definition">¶</a></dt>
<dd><p>Symbolic real solid harmonics up to order lmax.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="o">=</span> <span class="n">solid_harmonics</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>  <span class="c1"># Inclusive, so computes up to l = 6</span>
<span class="n">sh</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span>                <span class="c1"># symbolic f-phi angular function</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>lmax</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – highest order angular momentum quantum number</li>
<li><strong>scaled</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – if scaled, includes factor of 1 / (2 * np.pi ** 0.5)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="exatomic.algorithms.basis.car2sph">
<code class="descclassname">exatomic.algorithms.basis.</code><code class="descname">car2sph</code><span class="sig-paren">(</span><em>sh</em>, <em>cart</em>, <em>orderedp=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#car2sph"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.car2sph" title="Permalink to this definition">¶</a></dt>
<dd><p>Cartesian to spherical transform matrices.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sh</span> <span class="o">=</span> <span class="n">solid_harmonics</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>        <span class="c1"># symbolic solid harmonics</span>
<span class="n">cart</span> <span class="o">=</span> <span class="n">gen_enum_cartesian</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>   <span class="c1"># cartesian powers in a defined order</span>
<span class="n">c2s</span> <span class="o">=</span> <span class="n">car2sph</span><span class="p">(</span><span class="n">sh</span><span class="p">,</span> <span class="n">cart</span><span class="p">)</span>        <span class="c1"># dictionary of {l: transform_matrix}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sh</strong> (<em>OrderedDict</em>) – symbolic solid harmonics</li>
<li><strong>cart</strong> (<em>OrderedDict</em>) – cartesian powers in a defined order</li>
<li><strong>orderedp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – order l=1 as [‘x’, ‘y’, ‘z’], not [-1, 0, 1] (default True)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><em>c2s (OrderedDict)</em> – cartesian to spherical transform matrices</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="exatomic.algorithms.basis.diff_expr">
<code class="descclassname">exatomic.algorithms.basis.</code><code class="descname">diff_expr</code><span class="sig-paren">(</span><em>expr</em>, <em>cart='x'</em>, <em>order=1</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#diff_expr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.diff_expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the nth order derivative symbolically with respect to cart.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>expr</strong> (<em>symbolic</em>) – sympy or symengine expression</li>
<li><strong>cart</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – ‘x’, ‘y’, or ‘z’</li>
<li><strong>order</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – order of differentiation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><em>expr (symbolic)</em> – The symbolic derivative</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="exatomic.algorithms.basis.evaluate_expr">
<code class="descclassname">exatomic.algorithms.basis.</code><code class="descname">evaluate_expr</code><span class="sig-paren">(</span><em>expr</em>, <em>xs</em>, <em>ys</em>, <em>zs</em>, <em>arr=None</em>, <em>alpha=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#evaluate_expr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.evaluate_expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate symbolic expression on a numerical grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>expr</strong> (<em>symbolic</em>) – sympy or symengine expression</li>
<li><strong>xs</strong> (<em>np.ndarray</em>) – 1D-array of x values</li>
<li><strong>ys</strong> (<em>np.ndarray</em>) – 1D-array of y values</li>
<li><strong>zs</strong> (<em>np.ndarray</em>) – 1D-array of z values</li>
<li><strong>arr</strong> (<em>np.ndarray</em>) – additional 1D-array to multiply expression by</li>
<li><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.6)"><em>float</em></a>) – multiply expression by gaussian with exponent alpha</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="orbital.html#exatomic.algorithms.orbital_util.numerical_grid_from_field_params" title="exatomic.algorithms.orbital_util.numerical_grid_from_field_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exatomic.algorithms.orbital_util.numerical_grid_from_field_params()</span></code></a>
for grid construction details.</p>
</div>
</dd></dl>

<dl class="class">
<dt id="exatomic.algorithms.basis.BasisFunctions">
<em class="property">class </em><code class="descclassname">exatomic.algorithms.basis.</code><code class="descname">BasisFunctions</code><span class="sig-paren">(</span><em>uni</em>, <em>frame=0</em>, <em>cartp=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#BasisFunctions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.BasisFunctions" title="Permalink to this definition">¶</a></dt>
<dd><p>Composition wrapper class that leverages symbolic expressions using
symengine and numexpr, using values extracted from the numerical Shell
jitclasses, to evaluate basis functions on a numerical grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>uni</strong> (<a class="reference internal" href="../universe.html#exatomic.core.universe.Universe" title="exatomic.core.universe.Universe"><code class="xref py py-class docutils literal notranslate"><span class="pre">exatomic.core.universe.Universe</span></code></a>) – a universe with basis set</li>
<li><strong>frame</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – frame corresponding to basis set (default 0)</li>
<li><strong>cartp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – forces p function ordering as (x, y, z) not (-1, 0, 1)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="exatomic.algorithms.basis.BasisFunctions.integrals">
<code class="descname">integrals</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#BasisFunctions.integrals"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.BasisFunctions.integrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the overlap matrix using primitive cartesian integrals.</p>
</dd></dl>

<dl class="method">
<dt id="exatomic.algorithms.basis.BasisFunctions.enum_shell">
<code class="descname">enum_shell</code><span class="sig-paren">(</span><em>shl</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#BasisFunctions.enum_shell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.BasisFunctions.enum_shell" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a generator over angular momentum degrees of freedom.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>shl</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">exatomic.algorithms.numerical.Shell</span></code>) – basis set shell</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="exatomic.algorithms.basis.BasisFunctions.evaluate">
<code class="descname">evaluate</code><span class="sig-paren">(</span><em>xs=None</em>, <em>ys=None</em>, <em>zs=None</em>, <em>irrep=None</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#BasisFunctions.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.BasisFunctions.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate basis functions on a numerical grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>xs</strong> (<em>np.ndarray</em>) – 1D-array of x values</li>
<li><strong>ys</strong> (<em>np.ndarray</em>) – 1D-array of y values</li>
<li><strong>zs</strong> (<em>np.ndarray</em>) – 1D-array of z values</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – print code pathway</li>
<li><strong>irrep</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a><em>,</em><em>OrderedDict</em>) – irrep or {irrep: [vectors] for irrep in irreps}</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Default behavior returns symbolic expressions if xs is None.
See <a class="reference internal" href="orbital.html#exatomic.algorithms.orbital_util.numerical_grid_from_field_params" title="exatomic.algorithms.orbital_util.numerical_grid_from_field_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exatomic.algorithms.orbital_util.numerical_grid_from_field_params()</span></code></a>
for grid construction details.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="exatomic.algorithms.basis.BasisFunctions.evaluate_diff">
<code class="descname">evaluate_diff</code><span class="sig-paren">(</span><em>xs</em>, <em>ys</em>, <em>zs</em>, <em>cart='x'</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/basis.html#BasisFunctions.evaluate_diff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.basis.BasisFunctions.evaluate_diff" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate basis function derivatives on a numerical grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>xs</strong> (<em>np.ndarray</em>) – 1D-array of x values</li>
<li><strong>ys</strong> (<em>np.ndarray</em>) – 1D-array of y values</li>
<li><strong>zs</strong> (<em>np.ndarray</em>) – 1D-array of z values</li>
<li><strong>cart</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.6)"><em>str</em></a>) – derivative with respect to cart (in [‘x’, ‘y’, ‘z’])</li>
<li><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – print code pathway</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">See <a class="reference internal" href="orbital.html#exatomic.algorithms.orbital_util.numerical_grid_from_field_params" title="exatomic.algorithms.orbital_util.numerical_grid_from_field_params"><code class="xref py py-meth docutils literal notranslate"><span class="pre">numerical_grid_from_field_params()</span></code></a>
for grid construction details.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<span class="target" id="module-exatomic.algorithms.harmonics"></span><div class="section" id="spherical-and-solid-harmonics">
<h2>Spherical and Solid Harmonics<a class="headerlink" href="#spherical-and-solid-harmonics" title="Permalink to this headline">¶</a></h2>
<p>These functions generate and manipulate spherical and solid harmonics. For solid harmonics, this
module provides numerical approaches for dealing with them.</p>
<dl class="class">
<dt id="exatomic.algorithms.harmonics.SolidHarmonics">
<em class="property">class </em><code class="descclassname">exatomic.algorithms.harmonics.</code><code class="descname">SolidHarmonics</code><a class="reference internal" href="../../_modules/exatomic/algorithms/harmonics.html#SolidHarmonics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.harmonics.SolidHarmonics" title="Permalink to this definition">¶</a></dt>
<dd><p>Store a collection of solid harmonic functions.</p>
</dd></dl>

<dl class="function">
<dt id="exatomic.algorithms.harmonics.solid_harmonics">
<code class="descclassname">exatomic.algorithms.harmonics.</code><code class="descname">solid_harmonics</code><span class="sig-paren">(</span><em>l</em>, <em>return_all=False</em>, <em>vectorize=False</em>, <em>standard_symbols=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/exatomic/algorithms/harmonics.html#solid_harmonics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.harmonics.solid_harmonics" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a set of spherical solid harmonic functions for a given angular
momentum.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solid_harmonics</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">{(0, 0): 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solid_harmonics</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="go">{(0, 0): 1, (1, -1): y, (1, 0): z, (1, 1): x}</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>l</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.6)"><em>int</em></a>) – Orbital angular moment</li>
<li><strong>return_all</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, return all computed solid harmonics</li>
<li><strong>vectorize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true, return vectorized functions (for numerical methods)</li>
<li><strong>standard_symbols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.6)"><em>bool</em></a>) – If true (default), convert to standard symbol notation (e.g. x*y =&gt; xy)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><em>functions (dict)</em> – Dictionary of (l, ml) keys and symbolic function values</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<span class="target" id="module-exatomic.algorithms.car2sph"></span><p>Cartesian to spherical transforms, obtained symbolically, numbafied.
Generated using the following code.</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">exatomic.algorithms.basis</span> <span class="kn">import</span> <span class="n">enum_cartesian</span><span class="p">,</span> <span class="n">car2sph</span>

<span class="k">def</span> <span class="nf">_car2sph_raw</span><span class="p">(</span><span class="n">L</span><span class="p">):</span>
    <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;{: 20.16f},&#39;</span>
    <span class="n">c2s</span> <span class="o">=</span> <span class="n">car2sph</span><span class="p">(</span><span class="n">sh</span><span class="p">,</span> <span class="n">enum_cartesian</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">L</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">L</span><span class="p">:</span>
            <span class="n">f</span> <span class="o">+=</span> <span class="s1">&#39;    if not L: return np.array([1.])</span><span class="se">\n</span><span class="s1">&#39;</span>
            <span class="k">continue</span>
        <span class="n">tmt</span> <span class="o">=</span> <span class="p">(</span><span class="n">fmt</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">c2s</span><span class="p">[</span><span class="n">L</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">//</span> <span class="mi">4</span><span class="p">)</span> <span class="o">+</span> <span class="n">fmt</span> <span class="o">*</span> <span class="p">(</span><span class="n">c2s</span><span class="p">[</span><span class="n">L</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">%</span> <span class="mi">4</span><span class="p">)</span>
        <span class="n">cdim</span><span class="p">,</span> <span class="n">sdim</span> <span class="o">=</span> <span class="n">c2s</span><span class="p">[</span><span class="n">L</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">scaled</span> <span class="o">=</span> <span class="n">c2s</span><span class="p">[</span><span class="n">L</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">**</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="n">tmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">scaled</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
        <span class="n">f</span> <span class="o">+=</span> <span class="s1">&#39;    if L == {}:</span><span class="se">\n</span><span class="s1">        return np.array([</span><span class="se">\n</span><span class="s1">{}])</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">vals</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span>
</pre></div>
</div>
<dl class="attribute">
<dt id="exatomic.algorithms.car2sph.car2sph_scaled">
<code class="descclassname">exatomic.algorithms.car2sph.</code><code class="descname">car2sph_scaled</code><a class="reference internal" href="../../_modules/exatomic/algorithms/car2sph.html#car2sph_scaled"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#exatomic.algorithms.car2sph.car2sph_scaled" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficients of symbolic solid harmonics / (2 * pi ** 0.5).</p>
</dd></dl>

<span class="target" id="module-exatomic.algorithms.numerical"></span><div class="section" id="numerical-methods-and-classes">
<h2>Numerical methods and classes<a class="headerlink" href="#numerical-methods-and-classes" title="Permalink to this headline">¶</a></h2>
<p>Everything in this module is implemented in numba.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="orbital.html" class="btn btn-neutral float-right" title="Orbital Algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../matrices.html" class="btn btn-neutral" title="Matrices" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright .
      Last updated on Apr 12, 2018.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.3.11',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>